---
name: agent-native-architecture
description: 构建以智能体为核心的应用程序。当设计自主智能体、创建 MCP 工具、实现自我修改系统，或构建功能由智能体在循环中实现结果的应用程序时，应使用此技能。
---

<why_now>
## 为什么是现在

软件智能体现在可以可靠地工作了。Claude Code 证明了一个具有访问 bash 和文件工具能力的 LLM，通过在循环中运行直到实现目标，可以自主完成复杂的多步骤任务。

令人惊讶的发现：**一个真正优秀的编码智能体实际上也是一个非常优秀的通用智能体。** 让 Claude Code 重构代码库的相同架构，也可以让智能体整理文件、管理阅读列表或自动化工作流。

Claude Code SDK 使这一切变得易于实现。您可以构建应用程序，其功能不是您编写的代码——而是您描述的结果，由具有工具的智能体在循环中运行直到实现结果。

这开辟了一个新领域：以 Claude Code 工作方式应用的软件，远远超出了编码范畴。
</why_now>

<core_principles>
## 核心原则

### 1. 均等性

**用户可以通过 UI 做的任何操作，智能体都应该能够通过工具实现。**

这是基本原则。没有它，其他都不重要。

想象一下，您构建了一个笔记应用程序，具有用于创建、组织和标记笔记的漂亮界面。用户询问智能体："创建一个总结我会议的笔记，并将其标记为紧急。"

如果您构建了创建笔记的 UI 但没有智能体功能来做同样的事情，智能体就会陷入困境。它可能会道歉或提出澄清问题，但它无法提供帮助——即使该操作对于使用界面的人类来说是微不足道的。

**解决方案：** 确保智能体具有可以完成 UI 可以做的一切的工具（或工具组合）。

这不是创建 UI 按钮到工具的 1:1 映射。而是确保智能体能够**实现相同的结果**。有时这是单个工具（`create_note`），有时是组合原语（`write_file` 到具有适当格式的笔记目录）。

**纪律：** 添加任何 UI 功能时，请问：智能体能够实现这个结果吗？如果不能，添加必要的工具或原语。

能力映射有助于：

| 用户操作 | 智能体如何实现 |
|---------|---------------|
| 创建笔记 | `write_file` 到笔记目录，或 `create_note` 工具 |
| 将笔记标记为紧急 | `update_file` 元数据，或 `tag_note` 工具 |
| 搜索笔记 | `search_files` 或 `search_notes` 工具 |
| 删除笔记 | `delete_file` 或 `delete_note` 工具 |

**测试：** 选择用户可以在 UI 中执行的任何操作。向智能体描述它。它能实现结果吗？
</core_principles>

<intake>
## 您需要帮助的以智能体为本架构的哪个方面？

1. **设计架构** - 从头开始规划新的以智能体为本的系统
2. **文件和工作区** - 使用文件作为通用接口、共享工作区模式
3. **工具设计** - 构建原语工具、动态能力发现、CRUD 完整性
4. **域工具** - 知道何时添加域工具 vs 保持使用原语
5. **执行模式** - 完成信号、部分完成、上下文限制
6. **系统提示** - 在提示中定义智能体行为、判断标准
7. **上下文注入** - 将运行时应用状态注入智能体提示
8. **操作均等性** - 确保智能体可以做用户可以做的所有事情
9. **自我修改** - 使智能体能够安全地自我演变
10. **产品设计** - 渐进式披露、潜在需求、批准模式
11. **移动模式** - iOS 存储、后台执行、检查点/恢复
12. **测试** - 测试以智能体为本应用的能力和均等性
13. **重构** - 使现有代码更以智能体为本

**等待响应后再继续。**
</intake>
