# 小学数学口算快速出题器方案

## 📁 文件信息

- **项目名称**: 小学数学口算快速出题器
- **创建日期**: 2026年2月
- **文件格式**: HTML5 + JavaScript
- **适用对象**: 小学生（1-6年级）
- **功能**: 自动生成数学口算题目，支持在线练习和打印

---

## ✨ 功能概述

### 🎯 核心功能

这是一个专为小学生设计的数学练习工具，支持自动出题、在线答题、计时测试和打印功能：

| 功能 | 说明 |
|------|------|
| ✅ **多年级支持** | 1-6年级不同难度级别 |
| ✅ **多种运算** | 加法、减法、乘法、除法、混合运算 |
| ✅ **三种题型** | 口算题（横式）、竖式题（笔算）、应用题（文字题） |
| ✅ **自定义设置** | 题目数量、数字范围、难度等级 |
| ✅ **在线答题** | 实时答题，自动判断对错 |
| ✅ **计时功能** | 练计时测试，培养速度 |
| ✅ **成绩统计** | 正确率、用时、错误题目分析 |
| ✅ **打印模式** | 生成试卷格式，支持批量生成（1-50份） |
| ✅ **语音播报** | 题目语音朗读（可选） |
| ✅ **答题记录** | 保存练习历史 |
| ✅ **错题本** | 自动记录错题，方便复习 |
| ✅ **智能排版** | 题目数量为4的倍数，整齐美观 |

---

## 🎓 年级与难度设置

### 一年级（6-7岁）

**难度特点**：
- 20以内加减法
- 不进位加法
- 不退位减法
- 认识数字和简单运算

**出题范围**：
```
加法：1-10 + 1-10
减法：1-10 - 1-10
结果范围：1-20
```

**示例题目**：
- 3 + 5 = ?
- 12 - 4 = ?
- 8 + 7 = ?

---

### 二年级（7-8岁）

**难度特点**：
- 100以内加减法
- 进位加法
- 退位减法
- 乘法口诀（1-9）

**出题范围**：
```
加法：1-50 + 1-50
减法：1-50 - 1-50
乘法：1-9 × 1-9
结果范围：1-100
```

**示例题目**：
- 35 + 27 = ?
- 82 - 45 = ?
- 6 × 7 = ?

---

### 三年级（8-9岁）

**难度特点**：
- 1000以内加减法
- 两位数乘一位数
- 简单除法
- 混合运算

**出题范围**：
```
加法：1-500 + 1-500
减法：1-500 - 1-500
乘法：10-99 × 2-9
除法：2-9的除法（整除）
结果范围：1-1000
```

**示例题目**：
- 456 + 238 = ?
- 723 - 189 = ?
- 45 × 3 = ?
- 72 ÷ 8 = ?
- 25 + 4 × 6 = ? （混合运算：先乘后加）
- 60 - 3 × 8 = ? （混合运算：先乘后减）

---

### 四年级（9-10岁）

**难度特点**：
- 万以内加减法
- 两位数乘两位数
- 三位数除以一位数
- 小数加减法

**出题范围**：
```
加法：1-5000 + 1-5000
减法：1-5000 - 1-5000
乘法：10-99 × 10-99
除法：2-9的除法
小数：一位小数加减
```

**示例题目**：
- 3456 + 1278 = ?
- 56 × 34 = ?
- 456 ÷ 6 = ?
- 3.5 + 2.7 = ?

---

### 五年级（10-11岁）

**难度特点**：
- 大数加减乘除
- 小数乘除法
- 简易方程
- 分数加减法

**出题范围**：
```
整数：10000以内四则运算
小数：两位小数运算
分数：同分母分数加减
混合运算：两步运算
```

**示例题目**：
- 12345 + 6789 = ?
- 3.45 × 2.3 = ?
- 1/5 + 2/5 = ?
- 25 + 15 × 3 = ?
- 48 ÷ 6 + 35 = ? （混合运算：先除后加）
- 100 - 36 ÷ 4 = ? （混合运算：先除后减）
- 应用题：小明买了5支铅笔，每支3元，又买了一个2元的橡皮，一共花了多少钱？

---

### 六年级（11-12岁）

**难度特点**：
- 综合运算
- 分数乘除法
- 百分数运算
- 比和比例

**出题范围**：
```
整数：综合四则运算
小数：复杂小数运算
分数：异分母分数运算
百分数：简单百分数问题
```

**示例题目**：
- 3/4 × 2/5 = ?
- 25% × 40 = ?
- 1/2 + 1/3 = ?
- 120 × 15% = ?

---

## 🚀 使用说明

### 模式一：在线练习模式

```
1. 选择年级和难度
2. 选择运算类型（加/减/乘/除/混合）
3. 设置题目数量（10/20/50/100）
4. 点击"开始答题"
5. 依次输入答案，按回车或点击"下一题"
6. 完成后查看成绩统计
7. 查看错题本，重新练习错题
```

### 模式二：计时测试模式

```
1. 设置测试时间（2分钟/5分钟/10分钟）
2. 选择年级和题型
3. 点击"开始测试"
4. 在规定时间内尽可能多地答题
5. 时间到自动结束
6. 查看答题速度和正确率
```

### 模式三：打印模式

```
1. 选择年级和题型（口算/竖式/应用题可多选）
2. 设置题目数量（口算/竖式为4的倍数，应用题为2的倍数）
3. 点击"生成试卷"
4. 设置生成份数（1-50份，支持全班使用）
5. 选择是否所有份使用相同题目
   • 勾选：所有试卷题目相同（便于统一讲解）
   • 不勾选：每份试卷题目不同（防止作弊）
6. 点击"确认生成"，自动弹出打印对话框
7. 可直接打印或选择"另存为PDF"
8. 试卷包含：
   • 学生信息栏（姓名、日期、用时、得分）
   • 口算题区（横式，每行4-5题）
   • 竖式题区（含横式和竖式，每行4题）
   • 应用题区（文字题 + 空白解答区域）
   • 草稿区（竖式计算空间）
```

---

## ⚙️ 功能设置

### 运算类型

| 类型 | 符号 | 说明 | 适用年级 |
|------|------|------|---------|
| **加法** | + | 基础加法运算 | 1-6年级 |
| **减法** | - | 基础减法运算 | 1-6年级 |
| **乘法** | × | 乘法口诀和乘法运算 | 2-6年级 |
| **除法** | ÷ | 整除除法运算 | 3-6年级 |
| **混合运算** | + - × ÷ | 混合四则运算 | 3-6年级 |

### 难度级别

| 级别 | 说明 | 数字范围 |
|------|------|---------|
| **简单** | 基础运算，无需进退位 | 较小范围 |
| **中等** | 需要进退位，有一定难度 | 中等范围 |
| **困难** | 复杂运算，需要多步计算 | 较大范围 |

### 题型类型

| 题型 | 说明 | 适用场景 |
|------|------|---------|
| **📝 口算题** | 横式计算，快速心算 | 培养计算速度和反应能力 |
| **✏️ 竖式题** | 竖式计算，笔算练习 | 掌握列竖式方法，提高准确性 |
| **📖 应用题** | 文字题目，生活场景 | 培养阅读理解和实际问题解决能力 |

### 混合运算题型详解

混合运算是指在同一个题目中包含两种或两种以上运算符的计算题，是小学数学的重要知识点。

#### 为什么需要混合运算？

- ✅ **培养运算顺序概念**：理解"先乘除、后加减"的运算法则
- ✅ **提升综合能力**：不再单一练习，而是综合运用多种运算
- ✅ **贴近实际应用**：生活中的问题往往需要多步计算
- ✅ **为复杂题目打基础**：为后续学习更复杂的数学做准备

#### 横式混合运算（口算/竖式）

**三年级**（入门）：
- 类型：乘加、乘减
- 示例：`15 + 3 × 4`、`28 - 2 × 9`
- 难度：较小数字，两位数结果

**四年级**（进阶）：
- 类型：乘加、乘减、除加、除减
- 示例：`20 + 36 ÷ 6`、`50 - 45 ÷ 5`
- 难度：整除除法，三位数结果

**五-六年级**（熟练）：
- 类型：全部8种混合运算
- 示例：`56 ÷ 7 + 15`、`72 ÷ 8 - 5`
- 难度：较大数字，复杂计算

#### 应用题混合运算

**三年级示例**：
> 小明买了5支铅笔，每支3元，又买了一个2元的橡皮，小明一共花了多少钱？

解题思路：
- 第一步：5 × 3 = 15（铅笔总价）
- 第二步：15 + 2 = 17（总共花费）

**四年级示例**：
> 老师把48支铅笔平均分给6个同学，每个同学分到的铅笔再加3支，每个同学一共有多少支铅笔？

解题思路：
- 第一步：48 ÷ 6 = 8（每人分到的铅笔）
- 第二步：8 + 3 = 11（每人最终的铅笔）

#### 运算顺序记忆口诀

```
混合运算要记牢，
先乘除来后加减。
有括号先算括号里，
从左到右依次算。
```

#### 教学建议

1. **循序渐进**：三年级开始接触，先做简单的乘加乘减
2. **强调顺序**：每次练习前提醒运算顺序
3. **步骤展示**：初期要求写出每一步的计算
4. **生活联系**：多用应用题，联系实际场景
5. **错题分析**：错误多是因为运算顺序混淆，针对性练习

### 题目数量

| 题型 | 可选数量 | 推荐场景 |
|------|---------|---------|
| **📝 口算题** | 12、16、20、24、28、32、36、40题 | 日常练习、课堂测验 |
| **✏️ 竖式题** | 8、12、16、20、24题 | 作业、单元测试 |
| **📖 应用题** | 2、4、6、8、10、12题 | 综合练习、期中期末 |

**说明**：
- 口算题和竖式题为**4的倍数**，便于整齐排版（每行4-5题）
- 应用题为**2的倍数**，适合分值计算（每题5分）
- 应用题提供**空白解答区域**，学生可书写完整解题过程

**推荐搭配**：
- 日常练习：口算20题 + 竖式16题 = 36题（约15分钟）
- 单元测试：口算24题 + 竖式20题 = 44题（约20分钟）
- 期中/期末：口算32题 + 竖式24题 + 应用8题 = 64题（约30分钟）

---

## 🎨 界面设计

### 主界面布局

```
┌─────────────────────────────────────────────┐
│   🧮 小学数学快速出题器                       │
│   口算 + 竖式 + 应用题                        │
├─────────────────────────────────────────────┤
│                                              │
│  📚 年级选择：[三年级 ▼]                     │
│                                              │
│  📝 题型选择（至少选一种）                    │
│  ☑ 口算题（横式计算）  ☑ 竖式题（笔算计算）  │
│  ☑ 应用题（文字题）                           │
│                                              │
│  ✏️ 运算类型（可多选）                        │
│  ☑ 加法  ☑ 减法  ☐ 乘法  ☐ 除法             │
│                                              │
│  📊 难度级别：[中等 ▼]                       │
│                                              │
│  📊 题目数量设置                              │
│  口算题：[20题 ▼]  竖式题：[16题 ▼]         │
│  应用题：[8题 ▼]                             │
│                                              │
│  💡 提示：口算/竖式为4的倍数，应用题为2的倍数 │
│                                              │
│  [🎮 开始练习]  [⏱️ 计时测试]                │
│  [🖨️ 生成试卷]  [📖 查看记录]                │
│                                              │
├─────────────────────────────────────────────┤
│  📈 学习统计                                 │
│  • 今日练习：3次  • 平均正确率：92.5%        │
│  • 累计做题：156题  • 最佳连续答对：15题      │
└─────────────────────────────────────────────┘
```

### 答题界面

```
┌─────────────────────────────────────┐
│  答题中...  第 5/20 题               │
│  ⏱️ 用时：01:23                      │
├─────────────────────────────────────┤
│                                      │
│       ┌─────────────────┐           │
│       │                 │           │
│       │   23 + 15 = ?   │           │
│       │                 │           │
│       └─────────────────┘           │
│                                      │
│       ┌─────────────────┐           │
│       │  答案：[    ]    │           │
│       └─────────────────┘           │
│                                      │
│  [🔊 读题]  [⏭️ 跳过]                │
│  [✅ 提交]                           │
│                                      │
└─────────────────────────────────────┘
```

### 成绩界面

```
┌─────────────────────────────────────┐
│  🎉 练习完成！                       │
├─────────────────────────────────────┤
│  📊 成绩统计                         │
│  • 题目数量：20题                    │
│  • 正确题数：18题                    │
│  • 错误题数：2题                     │
│  • 正确率：90%                       │
│  • 用时：03:45                       │
│  • 平均速度：11.25秒/题              │
│                                      │
│  📈 评价：优秀！继续加油！           │
│                                      │
│  [🔄 再练一次]  [📕 查看错题]        │
│  [📊 查看详情]  [🏠 返回主页]        │
└─────────────────────────────────────┘
```

---

## 📊 出题算法

### 加法出题规则

```javascript
// 确保和不超出范围
function generateAddition(grade) {
  let min, max;

  switch(grade) {
    case 1: min = 1; max = 10; break;  // 10以内
    case 2: min = 1; max = 50; break;  // 50以内
    case 3: min = 1; max = 100; break; // 100以内
    case 4: min = 1; max = 500; break; // 500以内
    case 5: min = 1; max = 1000; break; // 1000以内
    case 6: min = 1; max = 5000; break; // 5000以内
  }

  let a = random(min, max);
  let b = random(min, max);

  // 确保和不超出范围
  if (a + b > max * 2) {
    a = random(min, max - b);
  }

  return { question: `${a} + ${b}`, answer: a + b };
}
```

### 减法出题规则

```javascript
// 确保被减数大于减数，结果非负
function generateSubtraction(grade) {
  let min, max;

  switch(grade) {
    case 1: min = 1; max = 10; break;
    case 2: min = 1; max = 50; break;
    case 3: min = 1; max = 100; break;
    case 4: min = 1; max = 500; break;
    case 5: min = 1; max = 1000; break;
    case 6: min = 1; max = 5000; break;
  }

  let answer = random(min, max);
  let b = random(min, answer);
  let a = answer + b;

  return { question: `${a} - ${b}`, answer: answer };
}
```

### 乘法出题规则

```javascript
// 乘法口诀表和扩展乘法
function generateMultiplication(grade) {
  if (grade === 2) {
    // 乘法口诀 1-9
    let a = random(1, 9);
    let b = random(1, 9);
    return { question: `${a} × ${b}`, answer: a * b };
  } else if (grade === 3) {
    // 两位数乘一位数
    let a = random(10, 99);
    let b = random(2, 9);
    return { question: `${a} × ${b}`, answer: a * b };
  } else if (grade >= 4) {
    // 两位数乘两位数
    let a = random(10, 99);
    let b = random(10, 99);
    return { question: `${a} × ${b}`, answer: a * b };
  }
}
```

### 除法出题规则

```javascript
// 整除除法，确保能整除
function generateDivision(grade) {
  if (grade === 3) {
    // 2-9的除法
    let b = random(2, 9);
    let answer = random(1, 12);
    let a = b * answer;
    return { question: `${a} ÷ ${b}`, answer: answer };
  } else if (grade >= 4) {
    // 更复杂的除法
    let b = random(2, 20);
    let answer = random(1, 50);
    let a = b * answer;
    return { question: `${a} ÷ ${b}`, answer: answer };
  }
}
```

### 混合运算出题规则

```javascript
// 两步混合运算（先乘除后加减）
function generateMixed(grade) {
  // 根据年级选择合适的混合运算类型
  const types = getMixedTypes(grade);
  const type = randomChoice(types);

  switch(type) {
    case 'a + b × c':
      // 加法 + 乘法
      let b = random(2, 9);
      let c = random(2, 9);
      let bc = b * c;
      let a = random(1, getGradeMax(grade) - bc);
      return {
        question: `${a} + ${b} × ${c}`,
        answer: a + bc,
        steps: [`${b} × ${c} = ${bc}`, `${a} + ${bc} = ${a + bc}`]
      };

    case 'a - b × c':
      // 减法 + 乘法（确保结果非负）
      b = random(2, 9);
      c = random(2, 9);
      bc = b * c;
      a = random(bc + 1, getGradeMax(grade));
      return {
        question: `${a} - ${b} × ${c}`,
        answer: a - bc,
        steps: [`${b} × ${c} = ${bc}`, `${a} - ${bc} = ${a - bc}`]
      };

    case 'a × b + c':
      // 乘法 + 加法
      let a1 = random(2, 9);
      let b1 = random(2, 9);
      let a1b1 = a1 * b1;
      let c1 = random(1, getGradeMax(grade) - a1b1);
      return {
        question: `${a1} × ${b1} + ${c1}`,
        answer: a1b1 + c1,
        steps: [`${a1} × ${b1} = ${a1b1}`, `${a1b1} + ${c1} = ${a1b1 + c1}`]
      };

    case 'a × b - c':
      // 乘法 - 减法（确保结果非负）
      a1 = random(2, 9);
      b1 = random(2, 9);
      a1b1 = a1 * b1;
      c1 = random(1, a1b1 - 1);
      return {
        question: `${a1} × ${b1} - ${c1}`,
        answer: a1b1 - c1,
        steps: [`${a1} × ${b1} = ${a1b1}`, `${a1b1} - ${c1} = ${a1b1 - c1}`]
      };

    case 'a + b ÷ c':
      // 加法 + 除法（整除）
      let divisor = random(2, 9);
      let quotient = random(1, 12);
      let dividend = divisor * quotient;
      let a2 = random(1, getGradeMax(grade) - quotient);
      return {
        question: `${a2} + ${dividend} ÷ ${divisor}`,
        answer: a2 + quotient,
        steps: [`${dividend} ÷ ${divisor} = ${quotient}`, `${a2} + ${quotient} = ${a2 + quotient}`]
      };

    case 'a - b ÷ c':
      // 减法 - 除法（整除，确保结果非负）
      divisor = random(2, 9);
      quotient = random(1, 12);
      dividend = divisor * quotient;
      a2 = random(quotient + 1, getGradeMax(grade));
      return {
        question: `${a2} - ${dividend} ÷ ${divisor}`,
        answer: a2 - quotient,
        steps: [`${dividend} ÷ ${divisor} = ${quotient}`, `${a2} - ${quotient} = ${a2 - quotient}`]
      };

    case 'a ÷ b + c':
      // 除法 + 加法（整除）
      divisor = random(2, 9);
      quotient = random(1, 12);
      dividend = divisor * quotient;
      let c2 = random(1, getGradeMax(grade) - quotient);
      return {
        question: `${dividend} ÷ ${divisor} + ${c2}`,
        answer: quotient + c2,
        steps: [`${dividend} ÷ ${divisor} = ${quotient}`, `${quotient} + ${c2} = ${quotient + c2}`]
      };

    case 'a ÷ b - c':
      // 除法 - 减法（整除，确保结果非负）
      divisor = random(2, 9);
      quotient = random(1, 12);
      dividend = divisor * quotient;
      c2 = random(1, quotient - 1);
      return {
        question: `${dividend} ÷ ${divisor} - ${c2}`,
        answer: quotient - c2,
        steps: [`${dividend} ÷ ${divisor} = ${quotient}`, `${quotient} - ${c2} = ${quotient - c2}`]
      };
  }
}

// 根据年级获取合适的混合运算类型
function getMixedTypes(grade) {
  if (grade === 3) {
    // 三年级：简单的乘加、乘减
    return ['a + b × c', 'a - b × c', 'a × b + c', 'a × b - c'];
  } else if (grade === 4) {
    // 四年级：加入除法
    return ['a + b × c', 'a - b × c', 'a × b + c', 'a × b - c',
            'a + b ÷ c', 'a - b ÷ c'];
  } else {
    // 五六年级：全部类型
    return ['a + b × c', 'a - b × c', 'a × b + c', 'a × b - c',
            'a + b ÷ c', 'a - b ÷ c', 'a ÷ b + c', 'a ÷ b - c'];
  }
}

// 获取年级对应的最大值
function getGradeMax(grade) {
  const maxValues = { 3: 100, 4: 500, 5: 1000, 6: 5000 };
  return maxValues[grade] || 100;
}
```

**混合运算示例**（三年级）：
- 15 + 3 × 4 = 15 + 12 = **27**
- 28 - 2 × 9 = 28 - 18 = **10**
- 5 × 6 + 8 = 30 + 8 = **38**
- 7 × 8 - 15 = 56 - 15 = **41**

**混合运算示例**（四年级及以上）：
- 20 + 36 ÷ 6 = 20 + 6 = **26**
- 50 - 45 ÷ 5 = 50 - 9 = **41**
- 56 ÷ 7 + 15 = 8 + 15 = **23**
- 72 ÷ 8 - 5 = 9 - 5 = **4**

**运算顺序强调**：
- ⚠️ 先算乘除，后算加减
- ⚠️ 有括号先算括号里面的
- ✅ 答题界面上方显示运算顺序提示

### 应用题生成规则

```javascript
// 应用题模板库
const wordProblemTemplates = {
  add: [
    (a, b) => `小明有${a}个苹果，妈妈又给他买了${b}个，小明现在一共有多少个苹果？`,
    (a, b) => `图书馆有${a}本故事书，又新买了${b}本，现在一共有多少本故事书？`,
    (a, b) => `停车场原来有${a}辆汽车，又开来了${b}辆，现在停车场有多少辆汽车？`,
    (a, b) => `树上停了${a}只小鸟，又飞来了${b}只，现在树上一共有多少只小鸟？`,
    (a, b) => `篮子里有${a}个鸡蛋，又放了${b}个进去，篮子里现在有多少个鸡蛋？`,
  ],
  subtract: [
    (a, b) => `商店有${a}个篮球，卖出了${b}个，还剩多少个篮球？`,
    (a, b) => `小明有${a}元钱，买文具用去了${b}元，还剩下多少元？`,
    (a, b) => `池塘里有${a}条小鱼，游走了${b}条，还剩多少条？`,
    (a, b) => `公交车上原来有${a}人，到站下去了${b}人，车上还有多少人？`,
    (a, b) => `盒子里有${a}颗糖，小明吃掉了${b}颗，还剩多少颗？`,
  ],
  multiply: [
    (a, b) => `一支钢笔${a}元，买${b}支钢笔需要多少钱？`,
    (a, b) => `每个盒子装${a}个鸡蛋，${b}个盒子一共可以装多少个鸡蛋？`,
    (a, b) => `小明每天读${a}页书，读了${b}天，一共读了多少页？`,
    (a, b) => `一辆小汽车可以坐${a}人，${b}辆这样的汽车可以坐多少人？`,
    (a, b) => `一盒饼干有${a}块，买${b}盒饼干一共有多少块？`,
  ],
  divide: [
    (a, b) => `有${a}个苹果，平均分给${b}个小朋友，每个小朋友能分到几个？`,
    (a, b) => `小明有${a}元钱，买铅笔每支${b}元，可以买多少支铅笔？`,
    (a, b) => `一本故事书有${a}页，小明每天读${b}页，几天能读完？`,
    (a, b) => `有${a}朵花，每${b}朵扎成一束，可以扎成多少束？`,
    (a, b) => `${a}个同学分组做游戏，每组${b}人，可以分成多少组？`,
  ],
  // 新增：混合运算应用题模板（先乘除后加减）
  mixed: [
    // 乘法 + 加法
    (a, b, c) => `小明买了${b}支铅笔，每支${c}元，又买了一个${a}元的橡皮，小明一共花了多少钱？`,
    (a, b, c) => `图书馆买了${b}套书，每套${c}本，又买了${a}本故事书，图书馆一共买了多少本书？`,
    (a, b, c) => `超市运来${b}箱牛奶，每箱${c}盒，又运来${a}盒酸奶，超市一共运来多少盒饮品？`,
    (a, b, c) => `小华每天跑${b}圈，每圈${c}米，下午又跑了${a}米，小华今天一共跑了多少米？`,

    // 乘法 - 减法
    (a, b, c) => `商店有${a}个玩具，卖出了${b}盒，每盒${c}个，还剩多少个玩具？`,
    (a, b, c) => `小明有${a}颗糖，分给${b}个同学，每个同学${c}颗，还剩多少颗糖？`,
    (a, b, c) => `停车场有${a}辆汽车，开走了${b}辆面包车，每辆面包车坐${c}人是错的，应该是开走了${b}组车，每组${c}辆，还剩多少辆？`,  // 修正
    (a, b, c) => `妈妈买了${a}个苹果，做苹果派用了${b}个，每个派用${c}个苹果，还剩多少个？`,  // 这个场景不合适，改为
    (a, b, c) => `文具店有${a}本笔记本，卖出${b}包，每包${c}本，还剩多少本？`,

    // 除法 + 加法
    (a, b, c) => `老师把${a}支铅笔平均分给${b}个同学，每个同学分到的铅笔数再加${c}支，每个同学一共有多少支铅笔？`,
    (a, b, c) => `有${a}朵花，每${b}朵扎成一束，扎好后又买了${c}朵，现在一共有多少朵花？`,
    (a, b, c) => `小明把${a}颗糖平均分给${b}个朋友，每个朋友分到的糖再加${c}颗，每个朋友最终有多少颗糖？`,

    // 除法 - 减法
    (a, b, c) => `妈妈把${a}个苹果平均放在${b}个盘子里，每个盘子里的苹果吃掉${c}个，每个盘子还剩多少个苹果？`,
    (a, b, c) => `有${a}颗珠子，每${b}颗串成一串，串好后送人${c}串，还剩多少串？`,
    (a, b, c) => `一本书有${a}页，小明每天读${b}页，读了几天后，还差${c}页读完，小明读了多少天？`,

    // 加法 + 乘法（先加后乘的情境，需要括号）
    (a, b, c) => `一个书架有${a}层，上层有${b}本书，下层比上层多${c}本，书架上一共有多少本书？`,
    (a, b, c) => `文具店有${a}盒钢笔，每盒有${b}支，又进了${c}支，现在一共有多少支钢笔？`,
  ]
};

// 生成混合运算应用题
function generateMixedWordProblem(grade) {
  // 根据年级选择合适的混合运算类型
  const types = getMixedWordTypes(grade);
  const type = randomChoice(types);

  let question, answer, num1, num2, num3;

  switch(type) {
    case 'multiply_add':  // 先乘后加
      num1 = random(1, 20);  // 加数
      num2 = random(2, 9);   // 乘数1
      num3 = random(2, 9);   // 乘数2
      answer = num1 + num2 * num3;

      // 从模板中随机选择
      const maTemplates = wordProblemTemplates.mixed.slice(0, 4);
      const maTemplate = randomChoice(maTemplates);
      question = maTemplate(num1, num2, num3);
      break;

    case 'multiply_subtract':  // 先乘后减
      num1 = random(20, 100);  // 被减数（总数）
      num2 = random(2, 9);     // 乘数1
      num3 = random(2, 9);     // 乘数2
      // 确保结果非负
      while (num1 < num2 * num3) {
        num1 = random(num2 * num3 + 1, 100);
      }
      answer = num1 - num2 * num3;

      const msTemplates = wordProblemTemplates.mixed.slice(4, 8);
      const msTemplate = randomChoice(msTemplates);
      question = msTemplate(num1, num2, num3);
      break;

    case 'divide_add':  // 先除后加
      num3 = random(2, 9);     // 除数
      num2 = random(1, 12);    // 商
      num1 = num3 * num2;      // 被除数
      let addNum = random(1, 20);  // 加数
      answer = num2 + addNum;

      const daTemplates = wordProblemTemplates.mixed.slice(8, 11);
      const daTemplate = randomChoice(daTemplates);
      question = daTemplate(num1, num3, addNum);
      break;

    case 'divide_subtract':  // 先除后减
      num3 = random(2, 9);     // 除数
      num2 = random(5, 20);    // 商（要够减）
      num1 = num3 * num2;      // 被除数
      let subNum = random(1, num2 - 1);  // 减数
      answer = num2 - subNum;

      const dsTemplates = wordProblemTemplates.mixed.slice(11, 14);
      const dsTemplate = randomChoice(dsTemplates);
      question = dsTemplate(num1, num3, subNum);
      break;
  }

  return {
    type: 'mixedWordProblem',
    question: question,
    operation: type,
    num1: num1,
    num2: num2,
    num3: num3,
    answer: answer,
    steps: generateMixedSteps(type, num1, num2, num3)
  };
}

// 生成混合运算步骤说明
function generateMixedSteps(type, num1, num2, num3) {
  switch(type) {
    case 'multiply_add':
      return [
        `先计算：${num2} × ${num3} = ${num2 * num3}`,
        `再计算：${num1} + ${num2 * num3} = ${num1 + num2 * num3}`
      ];
    case 'multiply_subtract':
      return [
        `先计算：${num2} × ${num3} = ${num2 * num3}`,
        `再计算：${num1} - ${num2 * num3} = ${num1 - num2 * num3}`
      ];
    case 'divide_add':
      return [
        `先计算：${num1} ÷ ${num2} = ${Math.floor(num1 / num2)}`,
        `再计算：${Math.floor(num1 / num2)} + ${num3} = ${Math.floor(num1 / num2) + num3}`
      ];
    case 'divide_subtract':
      return [
        `先计算：${num1} ÷ ${num2} = ${Math.floor(num1 / num2)}`,
        `再计算：${Math.floor(num1 / num2)} - ${num3} = ${Math.floor(num1 / num2) - num3}`
      ];
  }
}

// 根据年级获取混合运算应用题类型
function getMixedWordTypes(grade) {
  if (grade === 3) {
    // 三年级：乘加、乘减
    return ['multiply_add', 'multiply_subtract'];
  } else if (grade === 4) {
    // 四年级：加入除法
    return ['multiply_add', 'multiply_subtract', 'divide_add', 'divide_subtract'];
  } else {
    // 五六年级：全部类型，可能增加难度
    return ['multiply_add', 'multiply_subtract', 'divide_add', 'divide_subtract'];
  }
}

// 生成应用题
function generateWordProblem(grade, difficulty, operation) {
  // 1. 根据运算类型和年级生成合适的数字
  let num1, num2, answer;
  switch(operation) {
    case 'add':
      num1 = random(min, Math.floor(max * 0.5));
      num2 = random(min, Math.floor(max * 0.5));
      answer = num1 + num2;
      break;
    // ... 其他运算类型
  }

  // 2. 随机选择一个模板
  const templates = wordProblemTemplates[operation];
  const template = templates[random(0, templates.length - 1)];
  const question = template(num1, num2);

  return {
    type: 'wordProblem',
    question: question,
    operation: operation,
    num1: num1,
    num2: num2,
    answer: answer
  };
}
```

**应用题特点**：
- ✅ 生活化场景：购物、分物品、图书馆、停车场等
- ✅ 语言简单易懂：适合小学生理解
- ✅ 数字合理：根据年级自动调整难度
- ✅ 多样化模板：每种运算5+个不同场景
- ✅ **混合运算应用题**：三年级起支持两步混合运算应用题（乘加、乘减、除加、除减）
- ✅ **运算顺序培养**：帮助理解"先乘除后加减"的运算规则
- ✅ **步骤提示**：部分模式显示计算步骤，培养解题思路
- ✅ 空白解答区：提供适当空间供学生书写完整解题过程（已优化尺寸）
- ✅ 灵活数量：2、4、6、8、10、12题可选（2的倍数便于评分）
- ✅ 紧凑布局：优化行距和区域大小，节省纸张空间

---

## 💡 特色功能

### 1. 智能难度调整

```
系统根据学生答题情况自动调整难度：

• 连续答对10题 → 自动提升难度
• 连续答错3题 → 自动降低难度
• 正确率低于60% → 建议复习基础
• 正确率高于90% → 可以挑战更高难度
```

### 2. 语音播报

- ✅ 点击"读题"按钮，朗读题目
- ✅ 支持中文数字朗读
- ✅ 自动朗读选项
- ✅ 朗读速度可调

### 3. 答题记录

```
保存每次练习的详细信息：

• 日期和时间
• 年级和题型
• 题目数量
• 正确率
• 用时
• 错题列表

可用于学习进度跟踪
```

### 4. 错题本

```
自动记录错题，方便复习：

• 显示题目和正确答案
• 显示学生错误答案
• 可重新练习错题
• 错题可导出打印
```

### 5. 打印功能

```
生成专业试卷格式：

• A4纸张优化布局
• 包含学生信息栏（姓名、日期、用时、得分）
• 三种题型分区（口算、竖式、应用题）
• 题目数量优化：口算/竖式为4的倍数，应用题为2的倍数
• 每行4-5题，完美适配A4宽度
• 竖式题包含横式和竖式两种展示
• 应用题提供空白解答区域（供书写完整解题过程）
• 智能草稿区：自动检测是否会跨页，如会跨页则自动取消
• 支持1-50份批量生成
• 可选择是否所有份使用相同题目
• 防作弊模式：每份试卷题目不同
• 自动分页，避免空白页
• 可直接打印或另存为PDF
```

**草稿区智能检测逻辑**：
- 系统会估算试卷内容的高度（题目数量 × 单题高度）
- 如果添加草稿区后会超出单页A4纸范围，自动取消草稿区
- 避免草稿区被分页切割，保持试卷整洁性
- 用户可根据需要手动选择题目数量来保留或去除草稿区

---

## 📈 学习统计

### 个人统计

- 📊 **今日练习**：练习次数、题目数量
- 📈 **正确率趋势**：最近7天的正确率变化
- ⏱️ **速度统计**：平均答题时间
- 🎯 **薄弱环节**：错误率高的题型分析
- 🏆 **成就系统**：连续答对、速度之星等

### 家长/教师模式

```
查看多个学生的统计数据：

• 学生列表管理
• 成绩对比分析
• 学习进度跟踪
• 导出学习报告
```

---

## 🎯 应用场景

### 家庭学习

- ✅ 日常口算练习
- ✅ 课后作业辅助
- ✅ 考前强化训练
- ✅ 家长监督学习进度

### 学校教学

- ✅ 课堂快速测验
- ✅ 生成作业试卷
- ✅ 分层教学（不同难度）
- ✅ 学生成绩管理

### 课后辅导

- ✅ 培训机构练习
- ✅ 一对一辅导工具
- ✅ 个性化出题
- ✅ 学习效果评估

---

## 🔧 技术特点

### 前端技术

```
HTML5 - 语义化标签
CSS3 - Flexbox/Grid布局
JavaScript - ES6+语法
LocalStorage - 本地数据存储
Web Speech API - 语音播报
Canvas - 打印渲染
```

### 性能优化

- ✅ 纯客户端运行，无需服务器
- ✅ 响应式设计，支持所有设备
- ✅ 快速加载，秒开应用
- ✅ 离线可用，无需网络
- ✅ 数据本地存储，保护隐私

---

## 📱 兼容性

### 浏览器支持

| 浏览器 | 版本 | 支持状态 |
|--------|------|---------|
| Chrome | 90+ | ✅ 完全支持 |
| Safari | 14+ | ✅ 完全支持 |
| Firefox | 88+ | ✅ 完全支持 |
| Edge | 90+ | ✅ 完全支持 |
| 微信浏览器 | 最新版 | ✅ 支持 |

### 设备支持

- ✅ PC电脑（Windows/Mac）
- ✅ 平板（iPad/Android）
- ✅ 手机（iOS/Android）

---

## 🛠️ 扩展功能（未来规划）

### 计划中的功能

- [ ] 多语言支持（英语、粤语等）
- [ ] 多用户系统
- [ ] 云端数据同步
- [ ] 排行榜功能
- [ ] 团队PK模式
- [ ] 更多运算类型（分数、小数、百分数）
- [ ] 应用题自动生成
- [ ] AI智能推荐题目
- [ ] 学习报告自动生成
- [ ] 家长端查看统计

---

## ⚠️ 注意事项

### 使用建议

1. **循序渐进**：从简单难度开始，逐步提升
2. **定时练习**：建议每天练习15-20分钟
3. **及时复习**：重视错题，定期复习
4. **鼓励为主**：多鼓励，少批评，培养兴趣
5. **适度练习**：避免过度练习，保持兴趣

### 常见问题

| 问题 | 解决方案 |
|------|---------|
| 答案输入错误 | 检查是否输入了正确数字 |
| 题目太难 | 降低难度级别 |
| 语音不播报 | 检查浏览器语音API支持 |
| 无法打印 | 检查打印机连接 |
| 数据丢失 | 不要清除浏览器缓存 |

---

## 📄 许可说明

- 本工具可自由使用和分享
- 适用于个人、家庭、学校教育用途
- 商业使用请联系作者

---

## 📊 版本对比

| 功能 | v1.0 | v1.1 | v1.2（当前） |
|------|------|-------------|-------------|
| **题型** | 口算、竖式 | 口算、竖式、应用题 | 口算、竖式、应用题 |
| **横式混合运算** | 基础 | 基础 | ✅ 完整支持（8种类型） |
| **应用题混合运算** | ❌ | ❌ | ✅ 三年级起支持 |
| **运算顺序提示** | ❌ | ❌ | ✅ 答题界面显示提示 |
| **题目数量** | 10、20、30、40、50题 | 口算/竖式：4的倍数（12-40题/8-24题）<br>应用题：2的倍数（2-12题） | 同v1.1 |
| **打印份数** | 1份 | 1-50份可选 | 同v1.1 |
| **防作弊** | ❌ | ✅ 支持每份不同题目 | 同v1.1 |
| **试卷排版** | 基础布局 | 优化布局（每行4-5题） | 同v1.1 |
| **应用题** | ❌ | ✅ 5+种场景模板 | ✅ 15+种场景（含混合运算） |
| **应用题解答区** | ❌ | ✅ 空白区域供书写过程 | 同v1.1 |
| **竖式题展示** | 仅竖式 | 横式+竖式双展示 | 同v1.1 |
| **草稿区** | ❌ | ✅ 智能检测，自动添加或取消（避免跨页） | 同v1.1 |
| **生成验证** | 基础验证 | 增强验证+错误提示 | 同v1.1 |
| **打印分页** | 可能有空白页 | ✅ 智能分页，避免空白页 | 同v1.1 |

---

## 🔄 更新日志

### v1.2 - 2026年2月5日（当前版本）

#### 新增功能
- ✨ **横式混合运算完善**：完整的8种混合运算类型（乘加、乘减、除加、除减及其变体）
- ✨ **应用题混合运算**：三年级起支持两步混合运算应用题
- ✨ **混合运算模板库**：15+种生活化场景模板
- ✨ **运算顺序提示**：答题界面上方显示"先乘除后加减"提示
- ✨ **步骤说明**：混合运算题目可显示计算步骤（教学模式）

#### 优化改进
- 🔧 **年级适配**：三年级（乘加乘减）、四年级（加入除法）、五六年级（全部类型）
- 🔧 **智能难度**：根据年级自动调整数字范围和运算复杂度
- 🔧 **示例更新**：各年级示例题目中增加混合运算示例
- 🔧 **算法完善**：混合运算确保结果合理、非负、整除

#### 混合运算类型
- ✅ `a + b × c`（先乘后加）
- ✅ `a - b × c`（先乘后减）
- ✅ `a × b + c`（先乘后加）
- ✅ `a × b - c`（先乘后减）
- ✅ `a + b ÷ c`（先除后加，整除）
- ✅ `a - b ÷ c`（先除后减，整除）
- ✅ `a ÷ b + c`（先除后加，整除）
- ✅ `a ÷ b - c`（先除后减，整除）

### v1.1 - 2026年2月

#### 新增功能
- ✨ **三种题型支持**：口算题、竖式题、应用题
- ✨ **应用题自动生成**：包含生活化场景（购物、分物品、图书馆等）
- ✨ **批量生成试卷**：支持1-50份一键生成
- ✨ **防作弊模式**：可选择每份试卷题目不同
- ✨ **智能排版优化**：题目数量改为4的倍数，便于整齐排列

#### 优化改进
- 🔧 **竖式题双展示**：同时显示横式和竖式，方便理解
- 🔧 **应用题解答区**：留出空白区域供书写完整解题过程（不再只给答案线）
- 🔧 **应用题尺寸优化**：缩小行距和解答区域，节省纸张空间
- 🔧 **智能草稿区**：自动检测是否会跨页，如会跨页则自动取消草稿区
- 🔧 **数量优化**：口算/竖式为4的倍数便于排版，应用题为2的倍数便于评分
- 🔧 **打印优化**：修复生成试卷功能，避免空白页
- 🔧 **验证增强**：运算类型选择过滤，防止验证失败
- 🔧 **错误提示**：生成失败时显示明确提示信息

#### 修复问题
- 🐛 修复生成试卷功能失效问题（变量未定义）
- 🐛 修复checkbox选择冲突问题（运算类型过滤）
- 🐛 优化打印分页逻辑（避免多余空白页）

### v1.0 - 2026年2月

- ✨ 初始版本发布
- 🎮 支持1-6年级出题
- 📝 加减乘除混合运算
- ⏱️ 计时功能
- 📊 成绩统计
- 📕 错题本
- 🖨️ 基础打印功能
- 🔊 语音播报
- 💾 本地存储记录

---

**祝小朋友们学习进步！📚✨**

---

## 📂 相关文件

| 文件名 | 说明 | 版本 |
|--------|------|------|
| `math-practice.html` | 完整版（口算+竖式+应用题+混合运算） | v1.2 |
| `口算、竖式.html` | 基础版（口算+竖式+混合运算） | v1.2 |
| `小学数学口算快速出题器方案.md` | 方案文档（本文件） | v1.2 |

---

*创建日期：2026年2月*
*维护：AI库*
*当前版本：v1.2*
*最后更新：2026年2月5日*
