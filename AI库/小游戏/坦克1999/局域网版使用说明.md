# 坦克大战1999 - 局域网版使用说明

## 📋 目录
1. [系统要求](#系统要求)
2. [安装步骤](#安装步骤)
3. [服务器设置](#服务器设置)
4. [客户端连接](#客户端连接)
5. [游戏操作](#游戏操作)
6. [常见问题](#常见问题)

---

## 系统要求

### 服务器端
- Node.js 14.0 或更高版本
- 操作系统: Windows/Linux/MacOS
- 网络端口: 8080 (确保防火墙允许此端口)

### 客户端
- 现代浏览器 (Chrome/Firefox/Edge/Safari)
- 网络连接: 与服务器在同一局域网

---

## 安装步骤

### 1. 安装Node.js

访问 [Node.js官网](https://nodejs.org/) 下载并安装最新LTS版本。

验证安装:
```bash
node --version
```

### 2. 安装WebSocket库

在游戏目录打开命令行,运行:

```bash
npm init -y
npm install ws
```

或者使用全局安装:

```bash
npm install -g ws
```

### 3. 准备游戏文件

确保以下文件在同一目录中:
- `server.js` - 服务器程序
- `tank-battle-lan.html` - 游戏客户端

---

## 服务器设置

### 启动服务器

在游戏目录打开命令行,运行:

```bash
node server.js
```

### 成功启动的标志

看到以下信息表示服务器启动成功:

```
🎮 坦克大战局域网服务器运行在端口 8080
等待玩家连接...
```

### 查看服务器IP地址

**Windows:**
```bash
ipconfig
```
查找 "IPv4 地址" (例如: 192.168.1.100)

**Linux/MacOS:**
```bash
ifconfig
```
或
```bash
ip addr show
```

查找 "inet" 地址

---

## 客户端连接

### 方法一: 本机测试

1. 打开浏览器
2. 输入文件路径或直接双击 `tank-battle-lan.html`
3. 服务器地址填写: `localhost:8080`
4. 输入昵称,创建或加入房间

### 方法二: 局域网连接

1. 确保服务器已启动
2. 在同一局域网的其他设备上打开浏览器
3. 直接打开 `tank-battle-lan.html` 文件
4. 服务器地址填写: `[服务器IP]:8080`
   - 例如: `192.168.1.100:8080`
5. 输入昵称,加入或创建房间

### 创建房间

1. 输入服务器地址和昵称
2. 点击 "创建房间"
3. 系统会生成一个6位房间号
4. 将房间号分享给其他玩家

### 加入房间

1. 输入服务器地址和昵称
2. 点击 "加入房间"
3. 输入其他玩家分享的房间号
4. 点击 "加入"

---

## 游戏操作

### 开始游戏

1. 至少需要2名玩家
2. 所有玩家点击 "准备" 按钮
3. 游戏自动开始

### 控制方式

**玩家控制:**
- `W` / `↑` - 向上移动
- `S` / `↓` - 向下移动
- `A` / `←` - 向左移动
- `D` / `→` - 向右移动
- `空格键` - 发射子弹

**聊天:**
- 在聊天框输入消息
- 按 `Enter` 发送

### 游戏目标

1. 消灭敌方坦克获得分数
2. 保护基地(老鹰)不被摧毁
3. 完成所有5个关卡
4. 与队友合作,争取最高分

### 计分规则

- 普通坦克(白色): 100分
- 快速坦克(黄色): 200分
- 重型坦克(红色): 300分
- 精英坦克(青色): 400分

---

## 常见问题

### Q: 无法连接到服务器

**A: 检查以下项目:**
1. 确认服务器已启动 (`node server.js` 正在运行)
2. 确认IP地址和端口正确
3. 检查防火墙设置,允许8080端口
4. 确认客户端和服务器在同一局域网

### Q: 端口8080被占用

**A: 修改 `server.js` 中的端口号:**
```javascript
const PORT = 8081; // 改为其他端口
```

### Q: 游戏卡顿/延迟高

**A: 可能原因:**
1. 网络带宽不足
2. 服务器性能不足
3. 同时在线玩家过多(建议最多4人)

### Q: 玩家掉线

**A:**
- 掉线玩家会自动从房间移除
- 剩余玩家可继续游戏
- 掉线玩家的坦克会消失

### Q: 如何结束游戏

**A:**
1. 游戏通关或失败后自动结束
2. 关闭浏览器窗口即可退出
3. 服务器端按 `Ctrl+C` 停止服务器

---

## 高级设置

### 修改最大玩家数

编辑 `server.js`,找到:
```javascript
this.maxPlayers = 4;
```
修改为想要的数值(建议不超过6)

### 修改关卡难度

编辑 `server.js`,修改 `generateMap()` 函数中的参数

### 自定义地图

编辑 `server.js` 中的 `generateMap()` 函数,创建自定义地图布局

---

## 技术支持

如遇到问题,请检查:
1. Node.js版本是否正确
2. WebSocket库是否安装
3. 防火墙和网络设置
4. 浏览器控制台错误信息(F12打开开发者工具)

---

**版本:** v1.0
**更新日期:** 2026-01-28
**开发者:** AI Assistant
