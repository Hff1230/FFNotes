<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç«‹ä½“å›¾å½¢å±•å¼€ - å¤šç§å±•å¼€æ–¹æ¡ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .control-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        select, button {
            padding: 12px 20px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        select {
            background: white;
            border: 2px solid #667eea;
            color: #333;
            min-width: 200px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
            min-width: 120px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            min-width: 300px;
        }

        .slider-container label {
            font-weight: bold;
            color: #333;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
        }

        .main-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .panel h2 {
            text-align: center;
            color: #667eea;
            margin-bottom: 20px;
        }

        .scene-3d {
            height: 450px;
            perspective: 1200px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .scene-2d {
            height: 450px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        /* 3D Cube Container */
        .cube-assembly {
            width: 180px;
            height: 180px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.3s;
        }

        .cube-face {
            position: absolute;
            width: 180px;
            height: 180px;
            border: 2px solid rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            transition: all 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            backface-visibility: visible;
            transform-origin: center;
            box-shadow: inset 0 0 30px rgba(255,255,255,0.3);
        }

        /* é¢çš„é¢œè‰² */
        .face-front { background: rgba(255, 107, 107, 0.95); }
        .face-back { background: rgba(78, 205, 196, 0.95); }
        .face-right { background: rgba(255, 230, 109, 0.95); }
        .face-left { background: rgba(26, 83, 92, 0.95); }
        .face-top { background: rgba(255, 159, 67, 0.95); }
        .face-bottom { background: rgba(84, 160, 255, 0.95); }

        /* 2D å±•å¼€å›¾ */
        .unfolded-grid {
            position: relative;
        }

        .unfolded-face {
            position: absolute;
            width: 90px;
            height: 90px;
            border: 2px solid rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transform: scale(0);
            transition: all 0.6s ease;
            box-shadow: inset 0 0 15px rgba(255,255,255,0.3);
        }

        .unfolded-face.show {
            opacity: 1;
            transform: scale(1);
        }

        /* ä¸åŒå±•å¼€æ–¹æ¡ˆçš„å¸ƒå±€ */
        /* æ–¹æ¡ˆ1: åå­—å½¢ - 141æ’åˆ— */
        .layout-cross .uf-top { top: 0; left: 90px; }
        .layout-cross .uf-bottom { top: 180px; left: 90px; }
        .layout-cross .uf-front { top: 90px; left: 90px; }
        .layout-cross .uf-back { top: 90px; left: 180px; }
        .layout-cross .uf-left { top: 90px; left: 0; }
        .layout-cross .uf-right { top: 90px; left: 270px; }

        /* æ–¹æ¡ˆ2: ä¸€å­—å½¢ - è¿ç»­6ä¸ª */
        .layout-line .uf-front { top: 90px; left: 0; }
        .layout-line .uf-top { top: 90px; left: 90px; }
        .layout-line .uf-back { top: 90px; left: 180px; }
        .layout-line .uf-bottom { top: 90px; left: 270px; }
        .layout-line .uf-left { top: 90px; left: 360px; }
        .layout-line .uf-right { top: 90px; left: 450px; }

        /* æ–¹æ¡ˆ3: Lå½¢ */
        .layout-l .uf-front { top: 0; left: 0; }
        .layout-l .uf-top { top: 0; left: 90px; }
        .layout-l .uf-back { top: 0; left: 180px; }
        .layout-l .uf-right { top: 90px; left: 0; }
        .layout-l .uf-bottom { top: 90px; left: 90px; }
        .layout-l .uf-left { top: 180px; left: 0; }

        /* æ–¹æ¡ˆ4: Zå½¢ */
        .layout-z .uf-front { top: 0; left: 0; }
        .layout-z .uf-top { top: 0; left: 90px; }
        .layout-z .uf-left { top: 90px; left: 90px; }
        .layout-z .uf-bottom { top: 180px; left: 90px; }
        .layout-z .uf-back { top: 180px; left: 0; }
        .layout-z .uf-right { top: 0; left: 180px; }

        /* æ–¹æ¡ˆ5: Tå½¢ */
        .layout-t .uf-top { top: 0; left: 90px; }
        .layout-t .uf-left { top: 90px; left: 0; }
        .layout-t .uf-front { top: 90px; left: 90px; }
        .layout-t .uf-right { top: 90px; left: 180px; }
        .layout-t .uf-bottom { top: 90px; left: 270px; }
        .layout-t .uf-back { top: 180px; left: 90px; }

        /* æ–¹æ¡ˆç¼©ç•¥å›¾ */
        .pattern-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .pattern-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .pattern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .pattern-card.active {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        .pattern-preview {
            width: 100%;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
        }

        .pattern-name {
            text-align: center;
            font-weight: bold;
            color: #333;
        }

        .pattern-desc {
            text-align: center;
            font-size: 12px;
            color: #666;
        }

        .info-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .info-panel h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-item {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 15px;
            border-radius: 10px;
        }

        .info-item label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .info-item .value {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
        }

        .cut-line-info {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }

        .cut-line-info h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .cut-line-info p {
            color: #856404;
            line-height: 1.6;
        }

        @media (max-width: 1200px) {
            .main-display {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ² ç«‹ä½“å›¾å½¢å±•å¼€ - å¤šç§æ–¹æ¡ˆå±•ç¤º</h1>
            <p class="subtitle">æ²¿ä¸åŒè¾¹å‰ªå¼€ï¼Œå¾—åˆ°ä¸åŒçš„å±•å¼€å›¾ | æ­£æ–¹ä½“æœ‰11ç§ä¸åŒçš„å±•å¼€æ–¹å¼</p>
        </header>

        <div class="controls">
            <div class="control-row">
                <select id="shapeSelect">
                    <option value="cube">æ­£æ–¹ä½“</option>
                    <option value="cuboid">é•¿æ–¹ä½“</option>
                </select>
                <button id="autoPlayBtn">â–¶ è‡ªåŠ¨å±•å¼€</button>
                <button id="pauseBtn" disabled>â¸ æš‚åœ</button>
                <button id="resetBtn">âŸ² é‡ç½®</button>
            </div>
            <div class="control-row">
                <div class="slider-container">
                    <label>å±•å¼€è¿›åº¦:</label>
                    <input type="range" id="progressSlider" min="0" max="100" value="0">
                    <span id="progressValue">0%</span>
                </div>
            </div>
        </div>

        <div class="main-display">
            <div class="panel">
                <h2>ğŸ² 3D ç«‹ä½“è§†å›¾</h2>
                <div class="scene-3d" id="scene3d">
                    <div class="cube-assembly" id="cube3d">
                        <div class="cube-face face-front" data-face="front">å‰</div>
                        <div class="cube-face face-back" data-face="back">å</div>
                        <div class="cube-face face-right" data-face="right">å³</div>
                        <div class="cube-face face-left" data-face="left">å·¦</div>
                        <div class="cube-face face-top" data-face="top">ä¸Š</div>
                        <div class="cube-face face-bottom" data-face="bottom">ä¸‹</div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2>ğŸ“„ å¹³é¢å±•å¼€å›¾</h2>
                <div class="scene-2d" id="scene2d">
                    <div class="unfolded-grid layout-cross" id="unfoldedGrid">
                        <div class="unfolded-face face-top uf-top">ä¸Š</div>
                        <div class="unfolded-face face-bottom uf-bottom">ä¸‹</div>
                        <div class="unfolded-face face-front uf-front">å‰</div>
                        <div class="unfolded-face face-back uf-back">å</div>
                        <div class="unfolded-face face-left uf-left">å·¦</div>
                        <div class="unfolded-face face-right uf-right">å³</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>ğŸ¨ é€‰æ‹©å±•å¼€æ–¹æ¡ˆï¼ˆæ²¿ä¸åŒè¾¹å‰ªå¼€ï¼‰</h2>
            <div class="pattern-selector" id="patternSelector">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <div class="info-panel">
            <h3 id="patternTitle">ğŸ“ åå­—å½¢å±•å¼€ï¼ˆ141æ’åˆ—ï¼‰</h3>
            <div class="info-content">
                <div class="info-item">
                    <label>å±•å¼€æ–¹æ¡ˆ</label>
                    <div class="value" id="patternName">åå­—å½¢</div>
                </div>
                <div class="info-item">
                    <label>æ’åˆ—æ–¹å¼</label>
                    <div class="value" id="patternLayout">1-4-1</div>
                </div>
                <div class="info-item">
                    <label>å‰ªå¼€è·¯å¾„</label>
                    <div class="value" id="cutPath">7æ¡æ£±</div>
                </div>
                <div class="info-item">
                    <label>ä¿ç•™è¿æ¥</label>
                    <div class="value" id="keepEdges">5æ¡æ£±</div>
                </div>
            </div>
            <div class="cut-line-info">
                <h4>âœ‚ï¸ å‰ªå¼€è¯´æ˜</h4>
                <p id="cutDescription">
                    ä¿æŒå‰é¢ä¸åŠ¨ï¼Œå‰ªå¼€å‰é¢ä¸ä¸Šé¢ã€ä¸‹é¢ã€å·¦é¢ã€å³é¢çš„è¿æ¥ï¼Œç„¶åæ²¿å‘¨å›´æ£±å‰ªå¼€ï¼Œ
                    å°†åé¢å±•å¼€åˆ°å³ä¾§ã€‚è¿™æ˜¯æœ€å¸¸è§çš„å±•å¼€æ–¹å¼ï¼Œå‘ˆåå­—å½¢ã€‚
                </p>
            </div>
        </div>
    </div>

    <script>
        // å±•å¼€æ–¹æ¡ˆå®šä¹‰
        const unfoldPatterns = {
            cube: [
                {
                    id: 'cross',
                    name: 'åå­—å½¢',
                    layout: '1-4-1',
                    desc: 'æœ€ç»å…¸çš„å±•å¼€æ–¹å¼ï¼Œä¸­é—´4ä¸ªé¢ï¼Œä¸Šä¸‹å„1ä¸ªé¢',
                    cutDesc: 'ä¿æŒå‰é¢ä¸åŠ¨ï¼Œå‰ªå¼€å‰ä¸ä¸Šã€ä¸‹çš„è¿æ¥ï¼Œä»¥åŠå‘¨å›´çš„æ£±ï¼Œå°†åé¢å±•å¼€åˆ°æœ€å³ä¾§ã€‚è¿™æ˜¯æœ€å¯¹ç§°çš„å±•å¼€æ–¹å¼ã€‚',
                    // 3Då±•å¼€æ—¶çš„æ—‹è½¬è½´å’Œè§’åº¦
                    rotations: {
                        front: { axis: 'none', angle: 0 },
                        back: { axis: 'left', angle: 180 },  // ç»•å·¦è¾¹æ—‹è½¬åˆ°å³ä¾§
                        right: { axis: 'left', angle: 90 },   // ç»•å·¦è¾¹æ—‹è½¬å±•å¼€
                        left: { axis: 'right', angle: -90 },  // ç»•å³è¾¹æ—‹è½¬å±•å¼€
                        top: { axis: 'bottom', angle: 90 },   // ç»•åº•è¾¹å‘ä¸Šæ—‹è½¬
                        bottom: { axis: 'top', angle: -90 }   // ç»•é¡¶è¾¹å‘ä¸‹æ—‹è½¬
                    },
                    layoutClass: 'layout-cross'
                },
                {
                    id: 'line',
                    name: 'ä¸€å­—å½¢',
                    layout: '6',
                    desc: '6ä¸ªé¢è¿æˆä¸€æ¡ç›´çº¿',
                    cutDesc: 'ä»å‰é¢å¼€å§‹ï¼Œä¾æ¬¡å‘å³å±•å¼€ï¼Œæ‰€æœ‰é¢åœ¨ä¸€æ¡ç›´çº¿ä¸Šã€‚éœ€è¦å‰ªå¼€5æ¡æ£±ï¼Œä¿ç•™ä¸€æ¡è¿æ¥æ‰€æœ‰é¢ã€‚',
                    rotations: {
                        front: { axis: 'none', angle: 0 },
                        top: { axis: 'left', angle: 90 },
                        back: { axis: 'left', angle: 90 },
                        bottom: { axis: 'left', angle: 90 },
                        left: { axis: 'left', angle: 90 },
                        right: { axis: 'right', angle: -90 }
                    },
                    layoutClass: 'layout-line'
                },
                {
                    id: 'l-shape',
                    name: 'Lå½¢',
                    layout: '3-2-1',
                    desc: 'å‘ˆLå½¢æ’åˆ—ï¼Œ3-2-1ç»“æ„',
                    cutDesc: 'å‰é¢ã€ä¸Šé¢ã€åé¢æ¨ªå‘æ’åˆ—ï¼Œå³é¢ã€ä¸‹é¢åœ¨å‰é¢ä¸‹æ–¹ï¼Œå·¦é¢åœ¨æœ€ä¸‹é¢ã€‚å½¢æˆLå½¢ç»“æ„ã€‚',
                    rotations: {
                        front: { axis: 'none', angle: 0 },
                        top: { axis: 'bottom', angle: 90 },
                        back: { axis: 'bottom', angle: 180 },
                        right: { axis: 'left', angle: -90 },
                        bottom: { axis: 'top', angle: -90 },
                        left: { axis: 'top', angle: -180 }
                    },
                    layoutClass: 'layout-l'
                },
                {
                    id: 'z-shape',
                    name: 'Zå½¢',
                    layout: '2-2-2',
                    desc: 'å‘ˆZå½¢æ’åˆ—ï¼Œ2-2-2ç»“æ„',
                    cutDesc: 'å‰é¢å’Œä¸Šé¢åœ¨ä¸Šæ–¹ï¼Œå·¦é¢å’Œä¸‹é¢åœ¨ä¸­é—´ï¼Œåé¢å’Œå³é¢åœ¨ä¸‹æ–¹ã€‚å½¢æˆé”¯é½¿çŠ¶Zå½¢ã€‚',
                    rotations: {
                        front: { axis: 'none', angle: 0 },
                        top: { axis: 'bottom', angle: 90 },
                        left: { axis: 'top', angle: 90 },
                        bottom: { axis: 'top', angle: 180 },
                        back: { axis: 'top', angle: 270 },
                        right: { axis: 'bottom', angle: -90 }
                    },
                    layoutClass: 'layout-z'
                },
                {
                    id: 't-shape',
                    name: 'Tå½¢',
                    layout: '1-4-1å˜ä½“',
                    desc: 'å‘ˆTå½¢æ’åˆ—',
                    cutDesc: 'ä¸Šé¢åœ¨é¡¶éƒ¨ï¼Œå·¦ã€å‰ã€å³ã€ä¸‹é¢æ¨ªå‘æ’åˆ—ï¼Œåé¢åœ¨åº•éƒ¨ã€‚å½¢æˆå€’Tå½¢ç»“æ„ã€‚',
                    rotations: {
                        front: { axis: 'none', angle: 0 },
                        top: { axis: 'bottom', angle: 90 },
                        left: { axis: 'right', angle: -90 },
                        right: { axis: 'left', angle: 90 },
                        bottom: { axis: 'left', angle: 180 },
                        back: { axis: 'bottom', angle: -180 }
                    },
                    layoutClass: 'layout-t'
                }
            ]
        };

        // çŠ¶æ€å˜é‡
        let currentShape = 'cube';
        let currentPattern = unfoldPatterns.cube[0];
        let isPlaying = false;
        let progress = 0;
        let rotationAngleX = -20;
        let rotationAngleY = -30;

        // DOMå…ƒç´ 
        const shapeSelect = document.getElementById('shapeSelect');
        const autoPlayBtn = document.getElementById('autoPlayBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const progressSlider = document.getElementById('progressSlider');
        const progressValue = document.getElementById('progressValue');
        const cube3d = document.getElementById('cube3d');
        const scene3d = document.getElementById('scene3d');
        const unfoldedGrid = document.getElementById('unfoldedGrid');
        const unfoldedFaces = document.querySelectorAll('.unfolded-face');
        const patternSelector = document.getElementById('patternSelector');
        const patternTitle = document.getElementById('patternTitle');
        const patternName = document.getElementById('patternName');
        const patternLayout = document.getElementById('patternLayout');
        const cutPath = document.getElementById('cutPath');
        const keepEdges = document.getElementById('keepEdges');
        const cutDescription = document.getElementById('cutDescription');

        // åˆå§‹åŒ–
        function init() {
            renderPatternSelector();
            setupEventListeners();
            updatePatternInfo(currentPattern);
            animate();
        }

        // æ¸²æŸ“æ–¹æ¡ˆé€‰æ‹©å™¨
        function renderPatternSelector() {
            const patterns = unfoldPatterns[currentShape];
            patternSelector.innerHTML = patterns.map(pattern => `
                <div class="pattern-card ${pattern.id === currentPattern.id ? 'active' : ''}"
                     data-pattern-id="${pattern.id}">
                    <div class="pattern-preview">
                        <svg width="120" height="60" viewBox="0 0 120 60">
                            ${getPatternSVG(pattern.id)}
                        </svg>
                    </div>
                    <div class="pattern-name">${pattern.name}</div>
                    <div class="pattern-desc">${pattern.layout} | ${pattern.desc}</div>
                </div>
            `).join('');

            // æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.pattern-card').forEach(card => {
                card.addEventListener('click', () => {
                    const patternId = card.dataset.patternId;
                    currentPattern = patterns.find(p => p.id === patternId);
                    reset();
                    updatePatternInfo(currentPattern);
                    renderPatternSelector();
                });
            });
        }

        // è·å–æ–¹æ¡ˆé¢„è§ˆSVG
        function getPatternSVG(patternId) {
            const svgs = {
                'cross': `
                    <rect x="35" y="5" width="20" height="20" fill="#ff9f43" stroke="#333" stroke-width="1"/>
                    <rect x="5" y="25" width="20" height="20" fill="#1a535c" stroke="#333" stroke-width="1"/>
                    <rect x="35" y="25" width="20" height="20" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <rect x="65" y="25" width="20" height="20" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                    <rect x="95" y="25" width="20" height="20" fill="#ffe66d" stroke="#333" stroke-width="1"/>
                    <rect x="35" y="45" width="20" height="20" fill="#54a0ff" stroke="#333" stroke-width="1"/>
                `,
                'line': `
                    <rect x="5" y="20" width="18" height="18" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="20" width="18" height="18" fill="#ff9f43" stroke="#333" stroke-width="1"/>
                    <rect x="45" y="20" width="18" height="18" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                    <rect x="65" y="20" width="18" height="18" fill="#54a0ff" stroke="#333" stroke-width="1"/>
                    <rect x="85" y="20" width="18" height="18" fill="#1a535c" stroke="#333" stroke-width="1"/>
                    <rect x="105" y="20" width="18" height="18" fill="#ffe66d" stroke="#333" stroke-width="1"/>
                `,
                'l-shape': `
                    <rect x="5" y="5" width="18" height="18" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="5" width="18" height="18" fill="#ff9f43" stroke="#333" stroke-width="1"/>
                    <rect x="45" y="5" width="18" height="18" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                    <rect x="5" y="25" width="18" height="18" fill="#ffe66d" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="25" width="18" height="18" fill="#54a0ff" stroke="#333" stroke-width="1"/>
                    <rect x="5" y="45" width="18" height="18" fill="#1a535c" stroke="#333" stroke-width="1"/>
                `,
                'z-shape': `
                    <rect x="5" y="5" width="18" height="18" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="5" width="18" height="18" fill="#ff9f43" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="25" width="18" height="18" fill="#1a535c" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="45" width="18" height="18" fill="#54a0ff" stroke="#333" stroke-width="1"/>
                    <rect x="5" y="45" width="18" height="18" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                    <rect x="45" y="5" width="18" height="18" fill="#ffe66d" stroke="#333" stroke-width="1"/>
                `,
                't-shape': `
                    <rect x="25" y="5" width="18" height="18" fill="#ff9f43" stroke="#333" stroke-width="1"/>
                    <rect x="5" y="25" width="18" height="18" fill="#1a535c" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="25" width="18" height="18" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <rect x="45" y="25" width="18" height="18" fill="#ffe66d" stroke="#333" stroke-width="1"/>
                    <rect x="65" y="25" width="18" height="18" fill="#54a0ff" stroke="#333" stroke-width="1"/>
                    <rect x="25" y="45" width="18" height="18" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                `
            };
            return svgs[patternId] || svgs['cross'];
        }

        // æ›´æ–°æ–¹æ¡ˆä¿¡æ¯
        function updatePatternInfo(pattern) {
            patternTitle.textContent = `ğŸ“ ${pattern.name}å±•å¼€ï¼ˆ${pattern.layout}æ’åˆ—ï¼‰`;
            patternName.textContent = pattern.name;
            patternLayout.textContent = pattern.layout;
            cutDescription.textContent = pattern.cutDesc;

            // æ›´æ–°å±•å¼€å›¾å¸ƒå±€
            unfoldedGrid.className = `unfolded-grid ${pattern.layoutClass}`;
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            autoPlayBtn.addEventListener('click', startAnimation);
            pauseBtn.addEventListener('click', pauseAnimation);
            resetBtn.addEventListener('click', reset);

            progressSlider.addEventListener('input', (e) => {
                progress = parseInt(e.target.value);
                updateProgress();
            });

            // é¼ æ ‡æ‹–æ‹½æ—‹è½¬
            let isDragging = false;
            let previousX, previousY;

            scene3d.addEventListener('mousedown', (e) => {
                isDragging = true;
                previousX = e.clientX;
                previousY = e.clientY;
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;

                const deltaX = e.clientX - previousX;
                const deltaY = e.clientY - previousY;

                rotationAngleY += deltaX * 0.5;
                rotationAngleX -= deltaY * 0.5;

                previousX = e.clientX;
                previousY = e.clientY;
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }

        // åŠ¨ç”»å¾ªç¯
        function animate() {
            cube3d.style.transform = `rotateX(${rotationAngleX}deg) rotateY(${rotationAngleY}deg)`;

            if (isPlaying && progress < 100) {
                progress += 0.5;
                progressSlider.value = progress;
                updateProgress();

                if (progress >= 100) {
                    pauseAnimation();
                }
            }

            requestAnimationFrame(animate);
        }

        // æ›´æ–°å±•å¼€è¿›åº¦
        function updateProgress() {
            progressValue.textContent = `${Math.round(progress)}%`;

            const unfoldFactor = progress / 100;

            // æ›´æ–°3Dé¢çš„å±•å¼€
            const rotations = currentPattern.rotations;
            const faces = cube3d.querySelectorAll('.cube-face');

            faces.forEach(face => {
                const faceName = face.dataset.face;
                const rotation = rotations[faceName];
                const baseTransform = getBaseTransform(faceName);

                if (rotation.axis === 'none') {
                    face.style.transform = baseTransform;
                } else {
                    const currentAngle = rotation.angle * unfoldFactor;
                    face.style.transform = `${baseTransform} rotate${getRotationAxis(rotation.axis)}(${currentAngle}deg)`;
                }
            });

            // æ›´æ–°2Då±•å¼€å›¾æ˜¾ç¤º
            unfoldedFaces.forEach((face, index) => {
                const showThreshold = 10 + (index * 15);
                if (progress >= showThreshold) {
                    face.classList.add('show');
                } else {
                    face.classList.remove('show');
                }
            });
        }

        // è·å–é¢çš„åŸºç¡€å˜æ¢
        function getBaseTransform(faceName) {
            const transforms = {
                front: 'translateZ(90px)',
                back: 'rotateY(180deg) translateZ(90px)',
                right: 'rotateY(90deg) translateZ(90px)',
                left: 'rotateY(-90deg) translateZ(90px)',
                top: 'rotateX(90deg) translateZ(90px)',
                bottom: 'rotateX(-90deg) translateZ(90px)'
            };
            return transforms[faceName];
        }

        // è·å–æ—‹è½¬è½´
        function getRotationAxis(axis) {
            const axisMap = {
                'left': 'Y',
                'right': 'Y',
                'top': 'X',
                'bottom': 'X'
            };
            return axisMap[axis] || 'Y';
        }

        // åŠ¨ç”»æ§åˆ¶
        function startAnimation() {
            if (progress >= 100) {
                progress = 0;
            }
            isPlaying = true;
            autoPlayBtn.disabled = true;
            pauseBtn.disabled = false;
        }

        function pauseAnimation() {
            isPlaying = false;
            autoPlayBtn.disabled = false;
            pauseBtn.disabled = true;
        }

        function reset() {
            pauseAnimation();
            progress = 0;
            progressSlider.value = 0;
            updateProgress();

            // é‡ç½®æ‰€æœ‰é¢çš„å˜æ¢
            const faces = cube3d.querySelectorAll('.cube-face');
            faces.forEach(face => {
                const faceName = face.dataset.face;
                face.style.transform = getBaseTransform(faceName);
            });
        }

        // å¯åŠ¨
        init();
    </script>
</body>
</html>
