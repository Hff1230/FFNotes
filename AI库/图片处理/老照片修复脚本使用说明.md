# 老照片修复脚本使用说明

## 📁 文件信息

- **脚本名称**: `老照片修复.jsx`
- **适用版本**: Adobe Photoshop CS6 及以上版本
- **脚本语言**: ExtendScript (JSX)
- **最新版本**: v2.0（新增AI智能上色功能）

---

## ✨ 新功能亮点

### 🎨 AI智能上色
为黑白老照片自动上色，支持6种预设方案：
- 智能自动上色（通用）
- 人物肖像（肤色优先）
- 风景照片（自然绿蓝）
- 复古暖色调
- 清凉冷色调
- 自定义双色调

**优势**：
- 创建多个独立颜色图层，可精确调整
- 使用高级混合模式（柔光、颜色、叠加等）
- 支持局部上色调整（图层蒙版）
- 非破坏性编辑，随时可修改

---

## 🚀 快速开始

### 方法一：直接运行（推荐）

1. **打开老照片**
   - 在Photoshop中打开需要修复的老照片

2. **运行脚本**
   - 菜单：`文件` → `脚本` → `浏览...`
   - 选择 `老照片修复.jsx` 文件
   - 点击"打开"

3. **配置选项**
   - 在弹出窗口中选择处理强度和修复选项
   - 点击"开始修复"

### 方法二：拖放运行

1. 将 `老照片修复.jsx` 拖放到Photoshop的快捷方式栏
2. 以后直接点击图标即可运行

### 方法三：自动加载（推荐高级用户）

1. 将脚本复制到以下目录：
   - **Windows**: `C:\Program Files\Adobe\Adobe Photoshop [版本]\Presets\Scripts\`
   - **Mac**: `/Applications/Adobe Photoshop [版本]/Presets/Scripts/`

2. 重启Photoshop
3. 脚本将出现在 `文件` → `脚本` 菜单中

---

## ⚙️ 功能说明

### 处理强度

| 强度 | 适用场景 | 效果 |
|------|---------|------|
| **轻度** | 照片保存较好，只需微调 | 轻微改善，保留更多原始细节 |
| **中度** | 常见老照片问题（推荐） | 平衡修复力度和自然度 |
| **重度** | 严重褪色、损伤 | 强力修复，可能改变照片风格 |

### 修复选项

| 选项           | 功能         | 说明              |
| ------------ | ---------- | --------------- |
| ✅ 自动调整色阶/对比度 | 修复暗淡、灰暗的问题 | 自动扩展色调范围        |
| ✅ 色彩平衡修正     | 减少泛黄、偏色问题  | 调整色彩平衡（减少黄、增加蓝） |
| ✅ 减少噪点/划痕    | 平滑噪点和轻微划痕  | 使用智能模糊技术        |
| ✅ 智能锐化       | 增强细节清晰度    | USM锐化，提升轮廓      |

### 🎨 黑白照片上色（新功能）

| 上色方案 | 适用场景 | 色彩特点 |
|---------|---------|---------|
| **智能自动上色** | 通用黑白照片 | 综合多种颜色，自动平衡效果 |
| **人物肖像** | 人物、脸部照片 | 肤色优先，温暖自然的肤色 |
| **风景照片** | 自然风景、户外 | 蓝天绿地，自然绿色和蓝色 |
| **复古暖色调** | 怀旧风格照片 | 金黄、橙红色温暖色调 |
| **清凉冷色调** | 现代风格照片 | 蓝、青、紫冷色系 |
| **自定义双色调** | 艺术效果 | 深蓝+金色双色调艺术效果 |

**上色强度**：
- **轻微**：颜色较淡，保留更多黑白质感
- **适中**：平衡色彩和明度（推荐）
- **强烈**：饱和度高，色彩浓郁

**使用技巧**：
- 上色前建议先完成基础修复（去噪、锐化）
- 可根据照片内容选择对应方案（人物选肖像，风景选风景）
- 上色后会创建多个颜色图层，可单独调整每个颜色层

### 色调处理

| 效果 | 说明 |
|------|------|
| **保持原色** | 修复后保持照片原有颜色 |
| **转换为黑白** | 将修复后的照片转为黑白效果 |
| **复古棕褐** | 添加复古棕褐色调（怀旧效果） |

---

## 💡 使用技巧

### 最佳实践

1. **先备份原照片**
   ```
   总是先复制一份原始照片作为备份
   ```

2. **分层处理**
   - 脚本会在不同图层上应用不同效果
   - 可以单独调整每个图层的：
     - 不透明度
     - 混合模式
     - 图层蒙版

3. **强度选择建议**
   - 人物肖像：使用"轻度"或"中度"
   - 风景照：可使用"重度"
   - 严重损伤：先"重度"修复，再手动微调

4. **上色技巧**
   - 人物照片：选择"人物肖像"方案，肤色更自然
   - 风景照片：选择"风景照片"方案，蓝天绿地效果更好
   - 艺术创作：尝试"复古暖色调"或"自定义双色调"
   - 上色强度建议先用"适中"，效果不理想再调整

5. **组合工作流**
   ```
   原照片 → 运行脚本 → 手动调整（修补工具、仿制图章） → 最终锐化
   ```

### 常见问题处理

| 问题 | 解决方法 |
|------|---------|
| **修复效果过强** | 降低对应图层的不透明度 |
| **色彩调整不够** | 复制"色彩平衡"图层以加强效果 |
| **噪点仍明显** | 添加"表面模糊"滤镜手动处理 |
| **锐化过度** | 降低"锐化层"不透明度或删除 |
| **局部效果不好** | 在图层上添加蒙版，局部擦除 |
| **上色效果不自然** | 降低🎨上色组中各图层的不透明度 |
| **某颜色过强** | 删除或降低对应颜色层（如"天空蓝调"过强） |
| **想要改变颜色** | 双击颜色层的缩略图，修改填充颜色 |

---

## 🎨 高级技巧

### 上色功能深度解析

#### 工作原理

脚本使用**多层色彩叠加技术**实现上色：

1. **创建纯色填充图层**：每种颜色创建独立图层
2. **智能混合模式**：使用柔光、颜色、叠加等模式融合
3. **不透明度控制**：根据强度自动计算最佳透明度
4. **分组管理**：所有颜色层归入"🎨 上色效果组"

#### 各方案详解

**1. 智能自动上色**
```
适用：大多数黑白照片
颜色层：基础暖色 + 天空蓝 + 植被绿 + 肤色暖调
效果：自然平衡，适合日常照片
```

**2. 人物肖像**
```
适用：人物、脸部特写
颜色层：基础肤色 + 暖色增强 + 红润脸颊 + 唇色
效果：突出肤色，温暖自然
```

**3. 风景照片**
```
适用：自然风景、户外场景
颜色层：天空蓝 + 草地绿 + 大地褐 + 自然增强
效果：蓝天白云、绿地植物
```

**4. 复古暖色调**
```
适用：怀旧风格、老照片
颜色层：怀旧金黄 + 温暖橙红 + 复古棕褐 + 岁月痕迹
效果：泛黄怀旧，年代感强
```

**5. 清凉冷色调**
```
适用：现代风格、冬季场景
颜色层：冷蓝基调 + 青色增强 + 紫色阴影 + 清凉高光
效果：清爽干净，现代感强
```

**6. 自定义双色调**
```
适用：艺术创作、特殊效果
颜色层：深蓝主色 + 金色副色 + 米白高光
效果：艺术双色调，视觉冲击力强
```

#### 高级上色技巧

**1. 局部上色**
```
- 在颜色层上添加图层蒙版
- 使用画笔工具（B）涂抹需要上色的区域
- 黑色画笔=隐藏颜色，白色画笔=显示颜色
```

**2. 手动调整颜色**
```
- 双击颜色图层的缩略图
- 在拾色器中修改颜色
- 可为每个颜色层设置自定义颜色
```

**3. 改变混合模式**
```
- 颜色模式：只改变色相和饱和度
- 柔光模式：增加对比度和颜色
- 叠加模式：强化效果
- 滤色模式：提亮并上色
```

**4. 调整图层顺序**
```
- 不同顺序产生不同效果
- 天空层通常在上方
- 肤色层通常在中间
- 基础色层通常在下方
```

#### 上色前处理建议

```推荐工作流：

1. 打开黑白照片
2. 运行脚本，先做基础修复（去噪、锐化）
3. 再运行脚本，启用上色功能
   或手动在修复后的照片上运行上色
4. 调整各颜色层的不透明度和蒙版
5. 最终调整色阶/曲线
```

#### 常见上色场景

| 照片类型 | 推荐方案 | 上色强度 | 注意事项 |
|---------|---------|---------|---------|
| 人物肖像 | 人物肖像 | 适中 | 注意肤色自然度 |
| 全家福 | 智能自动 | 适中/轻微 | 避免肤色过饱和 |
| 风景照 | 风景照片 | 适中 | 天空和草地分离 |
| 建筑照片 | 复古暖色 | 适中 | 保持建筑质感 |
| 街景照片 | 智能自动 | 轻微 | 避免颜色混乱 |
| 艺术创作 | 双色调 | 强烈 | 追求视觉冲击 |

---

### 自定义调整

脚本运行后，会创建多个图层：

```
📄 色阶调整 - 控制明暗对比
📄 色彩平衡 - 修正偏色
📄 降噪层 - 平滑噪点
📄 锐化层 - 增强清晰度
📄 整体提亮 - 调整整体亮度
📄 [可选] 黑白效果/棕褐色调
📁 [可选] 🎨 上色效果组（包含多个颜色层）
   ├─ 🎨 基础暖色层
   ├─ 🎨 天空蓝调
   ├─ 🎨 植被绿调
   └─ 🎨 肤色暖调
```

**调整方法**：
1. 选择对应图层
2. 调整 `不透明度`（0-100%）
3. 更改 `混合模式`（如：滤色、叠加）
4. 添加图层蒙版进行局部调整

### 手动增强步骤

脚本修复后，可继续手动优化：

1. **去除严重划痕**
   - 使用 `修复画笔工具` (J)
   - 使用 `仿制图章工具` (S)
   - 使用 `内容识别填充`

2. **修复折痕**
   - 复制图层
   - 滤镜 → 模糊 → 表面模糊
   - 添加蒙版，只显示折痕区域

3. **局部色彩修正**
   - 图层 → 新建调整图层 → 色相/饱和度
   - 使用蒙版限制作用范围

4. **最终输出**
   - 合并可见图层 (Ctrl+Shift+Alt+E / Cmd+Shift+Option+E)
   - 滤镜 → 锐化 → USM锐化
   - 导出为高质量JPEG或TIFF

---

## 📊 处理前对比

| 问题 | 修复效果 |
|------|---------|
| 照片泛黄、褪色 | ✅ 色彩平衡修正 |
| 对比度不足、灰暗 | ✅ 自动色阶/对比度 |
| 噪点明显 | ✅ 智能降噪 |
| 细节模糊 | ✅ 智能锐化 |
| 需要特殊色调 | ✅ 黑白/棕褐转换 |
| 黑白照片无色彩 | ✅ AI智能上色（新增） |

---

## ⚠️ 注意事项

1. **分辨率要求**
   - 建议照片分辨率不低于 1000×1000 像素
   - 低分辨率照片锐化效果可能不明显

2. **处理时间**
   - 大文件（>50MB）可能需要几秒到几十秒
   - 请耐心等待，不要强制关闭

3. **效果因图而异**
   - 脚本提供基础修复
   - 严重损伤仍需手动修复

4. **撤销操作**
   - 使用历史记录面板 (Ctrl+Shift+Z / Cmd+Shift+Z)
   - 或直接删除不需要的图层

---

## 🔧 故障排除

| 问题 | 解决方案 |
|------|---------|
| 脚本无法运行 | 检查Photoshop版本（需CS6+） |
| 提示"请先打开照片" | 确保在Photoshop中打开了照片 |
| 报错"没有权限" | 以管理员身份运行Photoshop |
| 效果不明显 | 尝试使用"重度"强度 |
| 程序崩溃 | 减少同时处理的照片数量 |

---

## 📝 快捷键参考

| 操作 | Windows | Mac |
|------|---------|-----|
| 运行脚本 | 文件→脚本→浏览 | 文件→脚本→浏览 |
| 撤销 | Ctrl+Z | Cmd+Z |
| 重做 | Ctrl+Shift+Z | Cmd+Shift+Z |
| 合并可见图层 | Ctrl+Shift+Alt+E | Cmd+Shift+Option+E |
| 调整不透明度 | 数字键（1-100%） | 数字键（1-100%） |

---

## 📞 反馈与改进

如有问题或建议，可以：
1. 修改脚本参数（打开.jsx文件编辑）
2. 记录常用设置
3. 根据自己的照片特点调整强度参数

---

**祝你修复愉快！✨**

---

## 📋 更新日志

**v2.0 - 2025年**
- ✨ 新增AI智能上色功能
- ✨ 支持6种上色预设方案
- ✨ 可调节上色强度（轻微/适中/强烈）
- ✨ 多图层独立控制，支持局部上色
- 🎨 优化混合模式和透明度算法
- 📚 完善使用文档

**v1.0 - 2025年**
- 基础修复功能（色阶、对比度、降噪、锐化）
- 色彩平衡修正
- 黑白/棕褐色调转换

---

*创建日期：2025年*
*适用版本：Photoshop CS6/CC/2018-2025*
*脚本版本：v2.0*
